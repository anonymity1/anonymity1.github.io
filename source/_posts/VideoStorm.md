---
title: VideoStorm
date: 2021-10-26 10:42:06
tags: 论文阅读
---

Live Video Analytics at Scale with Approximation and Delay-Tolerance(NSDI 2017)

背景：集群+视频流业务+用户服务质量侧写。思路亮点：提出服务质量侧写概念，打点视频流配置和QoS的关系，找到帕累托最优分界线，根据延迟和QoS确定视频流的配置。

<!-- more -->

## 研究背景

**集群**，无论部署位置是在边缘或者云端，都会面临任务需求和集群能够提供的服务能力不匹配的情况。当发生**需求**（总任务量）超过**供给**（集群的资源）时，有三类解决方案：

- 提升供给效率：改善集群内部资源分配方案，采用**并发**或**流水线**等方案**充分**利用集群内所有硬件的运算能力，避免集群内有硬件空转或产生通信等额外开销。

- 降低需求总量：将超出的任务量卸载至其他节点进行计算，比如**计算卸载**，**服务迁移**，**云边协同**等方案。

- 改善需求质量：即对于某些需求，资源消耗对于服务质量的提升有**边际效应**，因此可以在不大幅降低服务质量的情况下实现资源消耗的大幅降低。

对于第三点，如何找到**特定的业务**，以及为此类业务的服务质量和任务资源配置找到一个**确定的数值关系**，是改善需求质量的关键环节，本文就视频流分析业务给出一种基于侧写的任务资源配置方案。

## 研究问题

减载（load shedding）是流处理系统研究中关注的一个问题。相对于以往文献，这篇文章是针对视频流这一特定业务的**减载开篇之作**。新的贡献主要有两方面：

- 将多视频流查询的服务质量和延迟一起考虑

- 采用侧写的方式刻画视频流资源配置和服务质量关系

## 问题建模

资源需求和视频分析效果的侧写如下图所示，每一个点代表着一个配置和一个效果的对应关系。

资源需求的定义是**广义**的，这里采用使用的cpu内核数，对于一些具体硬件其资源需求有区别。影响资源需求的业务配置取决于具体业务，在视频流服务当中，业务配置可以是视频的**码率和采样率**。即较低的视频码率可以带来较高的视频流分析效果，从而可以以**较小的视频流分析效果下降为代价换取资源消耗的大幅减少**。

![](/img/VideoStorm/profile.png)

图中的最左侧曲线是**帕累托最优**分界线，即应尽可能使用该分界线上的配置。如何确定这条曲线和根据profiling结果分配集群资源呢？

首先定义效用函数，效用函数和视频流分析的**服务质量**和**延迟**有关：

![](/img/VideoStorm/utility.png)

因为调整的滞后性，当前要调整的是T时刻之后的效用，T时刻后时延为：

![](/img/VideoStorm/prediction.png)

根据效用和资源限制形式化问题，满足效用约束和资源总量约束

![](/img/VideoStorm/problem.png)

## 算法设计和挑战

先**离线**进行profiling。线上阶段因为总共有k个查询需要处理，按照**贪心**的思路，首先改进最坏的查询，调整方式为小步增加其资源消耗，直到达到profiling点，当在运行阶段发现有更好的profiling时（低资源需求，高效用，和视频流内容有关），更新配置信息。

## 思考

改善需求质量提升集群服务效率的**挖坑**之作。换各种方法profiling的后续之作层出不穷，也启发了后续针对其他业务的profiling方案。
